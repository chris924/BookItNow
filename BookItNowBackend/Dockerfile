# Official Maven image as a parent image
FROM maven:eclipse-temurin AS build

# Set the working directory to /app
WORKDIR /app

# Copy the project files
COPY pom.xml .
COPY src ./src

# Set environment variables
ENV SPRING_DATASOURCE_DRIVER_CLASS_NAME=${SPRING_DATASOURCE_DRIVER_CLASS_NAME}
ENV SPRING_DATASOURCE_URL=${SPRING_DATASOURCE_URL}
ENV SPRING_DATASOURCE_USERNAME=${SPRING_DATASOURCE_USERNAME}
ENV SPRING_DATASOURCE_PASSWORD=${SPRING_DATASOURCE_PASSWORD}
ENV SPRING_JPA_HIBERNATE_DDL_AUTO=${SPRING_JPA_HIBERNATE_DDL_AUTO}
ENV SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT=${SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT}
ENV SPRING_DATASOURCE_SSL_CA=${SPRING_DATASOURCE_SSL_CA}
ENV AVATAR_DIRECTORY_PATH=${AVATAR_DIRECTORY_PATH}





# Build the application using Maven
RUN mvn install -X

# Make port 8080 available to the world outside this container
EXPOSE 8080

# Run app when the container launches
CMD ["java", "-jar", "target/BookItNowBackend-0.0.1-SNAPSHOT.jar"]